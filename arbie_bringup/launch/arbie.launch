<launch>

    <arg name="simulated"/>
    <arg name="joints_connected"/>
    <arg name="pcb_connected"/>


    <!-- ===== MODEL ===== -->

    <param
        name="robot_description"
        command="cat $(find arbie_description)/model/arbie.urdf"
    />


    <!-- ===== VIRTUAL OR REAL HARDWARE ===== -->

    <group if="$(arg simulated)">
    <!-- Assumes that gzserver is running -->
    <node
        name="spawn_model"
        pkg="gazebo_ros"
        type="spawn_model"
        args="-param robot_description_sdf -sdf -x 0 -y 0 -z 0 -model arbie -b -gazebo_namespace gzserver"
    />
    </group>

    <rosparam
        file="$(find arbie_main)/config/usb.yaml"
        command="load"
    />

    <group if="$(arg joints_connected)">
        <include file="$(find arbie_hardware)/launch/main.launch"/>
    </group>

    <group if="$(arg pcb_connected)">
    <node
        name="power_board"
        pkg="rosserial_python"
        type="serial_node.py">
        <remap from="~port" to="/usb/pcb"/>
    </node>
    </group>

    <include file="$(find arbie_bringup)/launch/control.launch"/>
    <include file="$(find arbie_bringup)/launch/teleop.launch"/>
    <include file="$(find arbie_slam)/launch/slam.launch"/>

</launch>
